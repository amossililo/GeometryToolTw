<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>House Plan Sketcher</title>
    <link rel="stylesheet" href="assets/css/styles.css" />
  </head>
  <body>
    <header class="ribbon" role="region" aria-label="Drawing commands">
      <div class="ribbon-inner">
        <nav class="ribbon-tabs" role="tablist" aria-label="Command tabs">
          <button
            id="tab-home"
            class="ribbon-tab is-active"
            type="button"
            role="tab"
            aria-selected="true"
            aria-controls="panel-home"
            data-tab="home"
          >
            Home
          </button>
          <button
            id="tab-insert"
            class="ribbon-tab"
            type="button"
            role="tab"
            aria-selected="false"
            aria-controls="panel-insert"
            data-tab="insert"
          >
            Insert
          </button>
        </nav>

        <div class="ribbon-panels">
          <section
            id="panel-home"
            class="ribbon-panel is-active"
            role="tabpanel"
            aria-labelledby="tab-home"
            data-tab="home"
          >
            <div class="command-group">
              <h2>Drawing setup</h2>
              <div class="field-grid">
                <label class="field">
                  <span>Grid spacing</span>
                  <input id="gridSize" type="number" min="10" step="5" value="30" aria-describedby="gridHelp" />
                </label>
                <label class="field">
                  <span>Real-world scale</span>
                  <input id="unitLabel" type="text" value="m" aria-describedby="scaleHelp" />
                </label>
                <label class="field">
                  <span>Units per grid square</span>
                  <input id="unitPerCell" type="number" min="1" step="1" value="1" />
                </label>
              </div>
              <p id="gridHelp" class="helper-text">
                Larger grid spacing produces wider rooms. Adjust the scale labels to match your plan.
              </p>
              <p id="scaleHelp" class="helper-text">
                Example: set the unit label to feet or metres and choose how many units each grid square represents.
              </p>
            </div>

            <div class="command-group">
              <h2>Wall tools</h2>
              <div class="button-row">
                <button id="undoButton" class="secondary" type="button">Undo</button>
                <button id="eraseButton" class="secondary" type="button" disabled>Erase selected</button>
                <button id="clearButton" class="secondary" type="button">Clear</button>
                <button id="downloadButton" type="button">Download PNG</button>
              </div>
            </div>

            <div class="command-group">
              <h2>Export</h2>
              <label class="field field-stacked">
                <span>Google Apps Script URL</span>
                <input id="sheetsUrl" type="url" inputmode="url" placeholder="https://script.google.com/..." />
              </label>
              <p class="helper-text">
                Paste the URL for the Apps Script web app that appends rows to your sheet, then send the current metrics.
              </p>
              <button id="sendSheetsButton" type="button" class="secondary">Send to Google Sheets</button>
              <p id="sheetsStatus" class="status-line" role="status" aria-live="polite"></p>
            </div>
          </section>

          <section
            id="panel-insert"
            class="ribbon-panel"
            role="tabpanel"
            aria-labelledby="tab-insert"
            data-tab="insert"
            aria-hidden="true"
          >
            <div class="command-group">
              <h2>Placement tools</h2>
              <div class="tool-row">
                <button type="button" class="tool-button is-active" data-tool="draw" aria-pressed="true">Draw walls</button>
                <button type="button" class="tool-button" data-tool="window" aria-pressed="false">Insert window</button>
                <button type="button" class="tool-button" data-tool="door" aria-pressed="false">Insert door</button>
              </div>
              <p class="helper-text">
                Click a wall while a placement tool is active to drop a window or door. Press Escape to return to drawing.
              </p>
              <button id="clearOpeningsButton" type="button" class="secondary" disabled>Clear openings on wall</button>
            </div>
          </section>
        </div>

        <p id="commandHint" class="command-hint helper-text" role="status" aria-live="polite"></p>
      </div>
    </header>

    <div class="app-layout">
      <aside>
        <header>
          <h1>House Plan Sketcher</h1>
          <p>
            Create clean 2D floor plans with simple drag lines. Snap to the grid for crisp 90° corners and add openings as you go.
          </p>
        </header>

        <div class="card instructions-card" aria-label="Drawing instructions">
          <strong>How to work</strong>
          <ol class="instructions-list">
            <li>Use <strong>Draw walls</strong> to drag horizontal or vertical walls on the grid.</li>
            <li>Select the <strong>Insert</strong> tab and click walls to place windows or doors.</li>
            <li>Undo removes the latest wall, <strong>Erase selected</strong> deletes a chosen wall, and <strong>Clear</strong> starts fresh.</li>
          </ol>
          <p class="helper-text">
            Adjust grid spacing and units from the Home tab to match your project scale.
          </p>
        </div>

        <footer class="tip-footer">
          <strong>Tip</strong>
          Draw walls in the order you would walk around the building. This keeps measurements tidy and makes it easier to spot missing segments.
        </footer>
      </aside>

      <main>
        <div class="top-bar">
          <span>Choose commands from the ribbon, then work directly on the grid.</span>
          <span>Drag to draw walls; click a wall with Insert tools to add windows or doors.</span>
        </div>
        <div class="canvas-wrapper">
          <canvas id="planCanvas" aria-label="Plan canvas"></canvas>
          <section class="metrics-overlay" aria-label="Live metrics" aria-live="polite">
            <h2>Live metrics</h2>
            <div class="metrics">
              <div class="metric">
                <span class="metric-label">Walls drawn</span>
                <span id="wallCount">0</span>
              </div>
              <div class="metric">
                <span class="metric-label">Total length</span>
                <span id="totalLength">0</span>
              </div>
              <div class="metric">
                <span class="metric-label">Enclosed area</span>
                <span id="enclosedArea">0</span>
              </div>
              <div class="metric">
                <span class="metric-label">Last wall</span>
                <span id="lastWall">–</span>
              </div>
            </div>
            <p class="overlay-note">Metrics update automatically as you draw.</p>
          </section>
        </div>
      </main>
    </div>

    <script src="sheets-export.js"></script>
    <script type="module" src="assets/js/main.js"></script>
  </body>
</html>
